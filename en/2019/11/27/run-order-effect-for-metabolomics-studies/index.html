<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.79.1" />


<title>Run order effect for metabolomics studies - Miao Yu | 于淼 </title>
<meta property="og:title" content="Run order effect for metabolomics studies - Miao Yu | 于淼 ">



  








<link href='//cdn.bootcss.com/highlight.js/9.9.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">

<script async src="https://use.fontawesome.com/32c3d13def.js"></script>


		    
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-6S0CPNLV6R');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6S0CPNLV6R"></script>
<script src="https://ipmeta.io/plugin.js"></script>
<script>
   provideGtagPlugin({
      serviceProvider: 'dimension1',
      networkDomain: 'dimension2',
      networkType: 'dimension3',
   });
</script>
  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="https://yufree.cn/" class="nav-logo">
    <img src="https://yufree.cn/images/fish.png"
         width="50"
         height="50"
         alt="Yufree">
  </a>

  <ul class="nav-links">
    
    
    
    <li class=""><a href="/"> Home </a></li>
    
    <li class=""><a href="/en/about/"> About </a></li>
    
    <li class=""><a href="/en/"> Blog </a></li>
    
    <li class=""><a href="/en/vitae/"> Vitae </a></li>
    
    <li class=""><a href="https://bookdown.org/yufree/Metabolomics/"> MetaWorkflow </a></li>
    
    <li class=""><a href="/cn/"> 中文 </a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">2 min read</span>
    
    <h1 class="article-title">Run order effect for metabolomics studies

</h1>


<div class="article-date">
  <span> Miao Yu ·   2019/11/27</span>
  <span class="article-toolbar">
    
    <a href="/en/index.xml" type="application/rss+xml" target="_blank"><i class="fa fa-rss" aria-hidden="true" title="RSS feed"></i></a>
    
    <a href="https://twitter.com/home?status=Run&#43;order&#43;effect&#43;for&#43;metabolomics&#43;studies&#43;https%3A%2F%2Fyufree.cn%2Fen%2F2019%2F11%2F27%2Frun-order-effect-for-metabolomics-studies%2F&#43;via&#43;%40yu_free" target="_blank"><i class="fa fa-twitter" aria-hidden="true" title="Share via Twitter"></i></a>
    <a href="http://service.weibo.com/share/share.php?content=utf-8&amp;title=Run&#43;order&#43;effect&#43;for&#43;metabolomics&#43;studies&#43;%40%E8%B4%AB%E9%81%93yufree&amp;url=https%3A%2F%2Fyufree.cn%2Fen%2F2019%2F11%2F27%2Frun-order-effect-for-metabolomics-studies%2F" target="_blank"><i class="fa fa-weibo" aria-hidden="true" title="分享到新浪微博"></i></a>
    <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fa fa-cc" aria-hidden="true" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i></a>
    
    
    
    <a href="https://github.com/yufree/yufree.cn/edit/master/content/en/2019-11-27-run-order-effect-for-metabolomics-studies.md"><i class="fa fa-pencil-square-o" aria-hidden="true" title="Suggest an edit of this page"></i></a>
    
    </span>
</div>



    
    <div class="article-content">
      <p>For a regular XC-MS based metabolomics workflow, the injection sequence should be carefully designed. Chromatograph column will always change and the first and last samples would show a shift of baseline. Such shifts would be monotone increasing or decreasing. In this case, we need some pooled QC samples to dirty the column at the very beginning of sequence. However, how many pooled QC samples will give us a stable baseline?</p>
<p>To solve this issue, I defined a Pooled QC Stable Index(PQSI) in my enviGCMS package. Instead of checking the TIC of one sample, I will check the stability of each peak one by one. Here is a demo:</p>
<p><img src="https://yufree.github.io/presentation/figure/pooledQC.png" alt=""></p>
<p>As shown in above figure, for one peak repeated analyzed in one sequence, the intensity would become stable in long term. In math, the slope of every n(5 is the default number) samples along the run order would become 0. Then we could define the percentage of stable peaks as PQSI. Such index would be a value between 0 and 1. The higher of such index, more peaks within the QC would be affected by run order effect. You could use such function to check the QC samples to see if run order effects would influence the samples at the beginning of sequences. I include this <code>getpqsi</code> function in enviGCMS package and here is the demo:</p>
<pre><code class="language-{r}" data-lang="{r}">library(enviGCMS)
data(list)
order &lt;- 1:12
# n means how many points to build a linear regression model
n = 5
idx &lt;- getpqsi(list$data,order,n = n)
plot(idx~order[-(1:(n-1))],pch=19)
</code></pre><p><img src="https://yufree.github.io/enviGCMS/articles/PooledQC_files/figure-html/unnamed-chunk-6-1.png" alt=""></p>
<p>In this case, we could see at 5th sample, 30% peaks show correlation with the run order. However, ever since 6th sample, the run order effects could be ignore.</p>

    </div>
    

<nav id="article-nav">
    
    <a href="https://yufree.cn/en/2019/10/15/use-msconvert-in-linux-or-mac/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Use msconvert in Linux or Mac</div>
    </a>
    

    
    <a href="https://yufree.cn/en/2020/04/17/daily-check-for-coronavirus-data/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title">Daily check for coronavirus data <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></div>
    </a>
    
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = 'https:\/\/yufree.cn\/en\/2019\/10\/15\/use-msconvert-in-linux-or-mac\/';
    
  } else if (e.which == 39) {  
    
    url = 'https:\/\/yufree.cn\/en\/2020\/04\/17\/daily-check-for-coronavirus-data\/';
    
  }
  if (url) window.location = url;
});
</script>



  </article>

  
<section id="comments">
  <script>
  
  var runningOnBrowser = typeof window !== "undefined";
  
  var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
  
  var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;

  
  var disqus_config = function () {
    this.page.url = "https:\/\/yufree.cn" + location.pathname;
  };
  
  setTimeout(function () {
  if (!isBot && supportsIntersectionObserver) {
    
    var disqus_observer = new IntersectionObserver(function(entries) {
      
      if (entries[0].isIntersecting) {
        
        var d = document, s = d.createElement('script');
        s.src = '//yufree.disqus.com/embed.js'; s.async = true;
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        
        disqus_observer.disconnect();
      }
    }, { threshold: [0] });
    
    disqus_observer.observe(document.getElementById('disqus_thread'));
  } else {
    
    
    var d = document, s = d.createElement('script');
    s.src = '//yufree.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
}, 1);
  </script>
  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          
          
          <li><a href="https://github.com/yufree"><i class="fa fa-github" aria-hidden="true" title="Github"></i><span class="sr-only">Github</span></a></li>
          <li><a href="https://twitter.com/yu_free"><i class="fa fa-twitter" aria-hidden="true" title="Twitter"></i><span class="sr-only">Twitter</span></a></li>
          <li><a href="http://weibo.com/yufreecas"><i class="fa fa-weibo" aria-hidden="true" title="新浪微博"></i><span class="sr-only">新浪微博</span></a></li>
          
          <li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fa fa-cc" aria-hidden="true" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i><span class="sr-only">Attribution-NonCommercial-ShareAlike 4.0 International</span></a></li>
          <li><a href="/"><i class="fa fa-copyright" aria-hidden="true" title="Copyright"></i> 2023</a></li>
        </ul>
      </footer>
    </div>
    
    <script async src="https://yufree.cn/js/center-img.js"></script>
    
    <script async src="https://yufree.cn/js/fix-footnote.js"></script>
    
    

    



<script src="//cdn.bootcss.com/highlight.js/9.9.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.9.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.9.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.9.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'G-6S0CPNLV6R', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

